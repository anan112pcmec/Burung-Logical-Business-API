openapi: 3.0.3
info:
  title: Credential Service Seller API
  description: API documentation untuk layanan credential dan rekening seller
  version: 1.0.0
  contact:
    name: API Support
    email: support@example.com

servers:
  - url: http://localhost:8080
    description: Development server

tags:
  - name: Credential
    description: Operasi terkait credential seller
  - name: Rekening
    description: Operasi terkait rekening seller

paths:
  /seller/credential/update-password:
    patch:
      tags:
        - Credential
      summary: Update password seller
      description: Endpoint untuk mengubah password seller dengan verifikasi password lama
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PayloadPreUbahPasswordSeller'
            example:
              identitas_seller:
                id_seller: 12345
                username_seller: "john_seller"
                email_seller: "john@example.com"
              password_lama_ganti_password: "oldPassword123"
              password_baru_ganti_password: "newPassword456"
      responses:
        '200':
          description: Password berhasil diupdate
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseForm'
              example:
                status: 200
                service: "credential-service"
                pesan: "Password berhasil diubah, silakan validasi dengan OTP"
                response_payload: null
        '400':
          description: Bad request - password lama salah
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseForm'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseForm'

  /seller/credential/validate-password-otp:
    patch:
      tags:
        - Credential
      summary: Validasi perubahan password dengan OTP
      description: Endpoint untuk memvalidasi perubahan password menggunakan kode OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PayloadValidateUbahPasswordSellerOTP'
            example:
              identitas_seller:
                id_seller: 12345
                username_seller: "john_seller"
                email_seller: "john@example.com"
              otp_key_validate_ubah_password_seller: "123456"
      responses:
        '200':
          description: OTP valid, password berhasil diubah
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseForm'
              example:
                status: 200
                service: "credential-service"
                pesan: "Password berhasil divalidasi dan diubah"
                response_payload: null
        '400':
          description: OTP tidak valid atau expired
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseForm'

  /seller/credential/tambah-rekening:
    post:
      tags:
        - Rekening
      summary: Tambah rekening baru
      description: Endpoint untuk menambahkan nomor rekening bank seller
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PayloadTambahkanNorekSeller'
            example:
              identitas_seller:
                id_seller: 12345
                username_seller: "john_seller"
                email_seller: "john@example.com"
              nama_bank: "BCA"
              nomor_rekening: "1234567890"
              pemilik_rekening: "John Doe"
      responses:
        '201':
          description: Rekening berhasil ditambahkan
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseForm'
              example:
                status: 201
                service: "credential-service"
                pesan: "Rekening berhasil ditambahkan"
                response_payload:
                  id_rekening: 1
                  nama_bank: "BCA"
                  nomor_rekening: "1234567890"
                  pemilik_rekening: "John Doe"
        '400':
          description: Data tidak valid
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseForm'

  /seller/rekening/edit-rekening:
    patch:
      tags:
        - Rekening
      summary: Edit rekening seller
      description: Endpoint untuk mengedit informasi rekening seller yang sudah ada
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PayloadEditNorekSeler'
            example:
              identitas_seller:
                id_seller: 12345
                username_seller: "john_seller"
                email_seller: "john@example.com"
              id_rekening: 1
              nama_bank: "Mandiri"
              nomor_rekening: "9876543210"
              pemilik_rekening: "John Doe Updated"
      responses:
        '200':
          description: Rekening berhasil diupdate
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseForm'
              example:
                status: 200
                service: "credential-service"
                pesan: "Rekening berhasil diupdate"
                response_payload:
                  id_rekening: 1
                  nama_bank: "Mandiri"
                  nomor_rekening: "9876543210"
                  pemilik_rekening: "John Doe Updated"
        '404':
          description: Rekening tidak ditemukan
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseForm'

  /seller/rekening/set-default-rekening:
    patch:
      tags:
        - Rekening
      summary: Set rekening sebagai default
      description: Endpoint untuk mengatur rekening tertentu sebagai rekening default seller
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PayloadSetDefaultRekeningSeller'
            example:
              identitas_seller:
                id_seller: 12345
                username_seller: "john_seller"
                email_seller: "john@example.com"
              id_rekening: 1
      responses:
        '200':
          description: Rekening berhasil diset sebagai default
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseForm'
              example:
                status: 200
                service: "credential-service"
                pesan: "Rekening berhasil diset sebagai default"
                response_payload:
                  id_rekening: 1
                  is_default: true
        '404':
          description: Rekening tidak ditemukan
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseForm'

  /seller/credential/hapus-rekening:
    delete:
      tags:
        - Rekening
      summary: Hapus rekening seller
      description: Endpoint untuk menghapus rekening seller
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PayloadHapusNorekSeller'
            example:
              identitas_seller:
                id_seller: 12345
                username_seller: "john_seller"
                email_seller: "john@example.com"
              id_rekening: 1
              nomor_rekening_hapus_rekening: "1234567890"
      responses:
        '200':
          description: Rekening berhasil dihapus
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseForm'
              example:
                status: 200
                service: "credential-service"
                pesan: "Rekening berhasil dihapus"
                response_payload: null
        '404':
          description: Rekening tidak ditemukan
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseForm'

components:
  schemas:
    IdentitySeller:
      type: object
      required:
        - id_seller
        - username_seller
        - email_seller
      properties:
        id_seller:
          type: integer
          format: int32
          description: ID unik seller
          example: 12345
        username_seller:
          type: string
          description: Username seller
          example: "john_seller"
        email_seller:
          type: string
          format: email
          description: Email seller
          example: "john@example.com"

    ResponseForm:
      type: object
      properties:
        status:
          type: integer
          format: int32
          description: HTTP status code
          example: 200
        service:
          type: string
          description: Nama service yang menangani request
          example: "credential-service"
        pesan:
          type: string
          description: Pesan response
          example: "Operasi berhasil"
        response_payload:
          description: Data payload response (bisa berupa object atau null)
          example: null

    PayloadPreUbahPasswordSeller:
      type: object
      required:
        - identitas_seller
        - password_lama_ganti_password
        - password_baru_ganti_password
      properties:
        identitas_seller:
          $ref: '#/components/schemas/IdentitySeller'
        password_lama_ganti_password:
          type: string
          format: password
          description: Password lama seller
          example: "oldPassword123"
        password_baru_ganti_password:
          type: string
          format: password
          description: Password baru seller
          example: "newPassword456"

    PayloadValidateUbahPasswordSellerOTP:
      type: object
      required:
        - identitas_seller
        - otp_key_validate_ubah_password_seller
      properties:
        identitas_seller:
          $ref: '#/components/schemas/IdentitySeller'
        otp_key_validate_ubah_password_seller:
          type: string
          description: Kode OTP untuk validasi perubahan password
          example: "123456"
          minLength: 6
          maxLength: 6

    PayloadTambahkanNorekSeller:
      type: object
      required:
        - identitas_seller
        - nama_bank
        - nomor_rekening
        - pemilik_rekening
      properties:
        identitas_seller:
          $ref: '#/components/schemas/IdentitySeller'
        nama_bank:
          type: string
          description: Nama bank
          example: "BCA"
        nomor_rekening:
          type: string
          description: Nomor rekening bank
          example: "1234567890"
        pemilik_rekening:
          type: string
          description: Nama pemilik rekening
          example: "John Doe"

    PayloadEditNorekSeler:
      type: object
      required:
        - identitas_seller
        - id_rekening
        - nama_bank
        - nomor_rekening
        - pemilik_rekening
      properties:
        identitas_seller:
          $ref: '#/components/schemas/IdentitySeller'
        id_rekening:
          type: integer
          format: int64
          description: ID rekening yang akan diedit
          example: 1
        nama_bank:
          type: string
          description: Nama bank
          example: "Mandiri"
        nomor_rekening:
          type: string
          description: Nomor rekening bank
          example: "9876543210"
        pemilik_rekening:
          type: string
          description: Nama pemilik rekening
          example: "John Doe"

    PayloadSetDefaultRekeningSeller:
      type: object
      required:
        - identitas_seller
        - id_rekening
      properties:
        identitas_seller:
          $ref: '#/components/schemas/IdentitySeller'
        id_rekening:
          type: integer
          format: int64
          description: ID rekening yang akan diset sebagai default
          example: 1

    PayloadHapusNorekSeller:
      type: object
      required:
        - identitas_seller
        - id_rekening
        - nomor_rekening_hapus_rekening
      properties:
        identitas_seller:
          $ref: '#/components/schemas/IdentitySeller'
        id_rekening:
          type: integer
          format: int64
          description: ID rekening yang akan dihapus
          example: 1
        nomor_rekening_hapus_rekening:
          type: string
          description: Nomor rekening untuk konfirmasi penghapusan
          example: "1234567890"